import csv
from dateutil import parser
from datetime import datetime

birdy = ['Excalfactoria chinensis', 'Gallus gallus', 'Dendrocygna arcuata', 'Dendrocygna javanica', 'Nettapus coromandelianus', 'Spatula querquedula', 'Spatula clypeata', 'Mareca strepera', 'Mareca penelope', 'Anas acuta', 'Aythya fuligula', 'Lyncornis temminckii', 'Caprimulgus jotaka', 'Caprimulgus macrurus', 'Caprimulgus affinis', 'Hemiprocne longipennis', 'Hemiprocne comata', 'Collocalia affinis', 'Aerodramus maximus', 'Aerodramus germani', 'Rhaphidura leucopygialis', 'Hirundapus caudacutus', 'Hirundapus cochinchinensis', 'Hirundapus giganteus', 'Cypsiurus balasiensis', 'Apus apus', 'Apus pacificus', 'Apus nipalensis', 'Centropus sinensis', 'Centropus bengalensis', 'Phaenicophaeus sumatranus', 'Clamator coromandus', 'Clamator jacobinus', 'Eudynamys scolopaceus', 'Chrysococcyx maculatus', 'Chrysococcyx xanthorhynchus', 'Chrysococcyx basalis', 'Chrysococcyx minutillus', 'Cacomantis sonneratii', 'Cacomantis merulinus', 'Cacomantis sepulcralis', 'Surniculus lugubris', 'Hierococcyx sparverioides', 'Hierococcyx fugax', 'Hierococcyx nisicolor', 'Cuculus micropterus', 'Cuculus saturatus', 'Streptopelia orientalis', 'Streptopelia tranquebarica', 'Chalcophaps indica', 'Geopelia striata', 'Treron fulvicollis', 'Treron olax', 'Treron bicinctus', 'Treron curvirostra', 'Ptilinopus jambu', 'Ducula aenea', 'Ducula badia', 'Ducula bicolor', 'Heliopais personatus', 'Rallina fasciata', 'Rallina eurizonoides', 'Lewinia striata', 'Amaurornis phoenicurus', 'Zapornia pusilla', 'Zapornia fusca', 'Zapornia paykullii', 'Poliolimnas cinereus', 'Gallicrex cinerea', 'Porphyrio poliocephalus', 'Gallinula chloropus', 'Fulica atra', 'Tachybaptus ruficollis', 'Turnix suscitator', 'Esacus magnirostris', 'Himantopus himantopus', 'Himantopus leucocephalus', 'Vanellus cinereus', 'Vanellus indicus', 'Pluvialis fulva', 'Pluvialis squatarola', 'Charadrius hiaticula', 'Charadrius dubius', 'Charadrius alexandrinus', 'Charadrius dealbatus', 'Charadrius peronii', 'Charadrius mongolus', 'Charadrius leschenaultii', 'Charadrius veredus', 'Rostratula benghalensis', 'Hydrophasianus chirurgus', 'Numenius phaeopus', 'Numenius minutus', 'Numenius madagascariensis', 'Numenius arquata', 'Limosa lapponica', 'Limosa limosa', 'Arenaria interpres', 'Calidris tenuirostris', 'Calidris canutus', 'Calidris pugnax', 'Calidris falcinellus', 'Calidris acuminata', 'Calidris ferruginea', 'Calidris temminckii', 'Calidris subminuta', 'Calidris pygmaea', 'Calidris ruficollis', 'Calidris alba', 'Calidris minuta', 'Calidris melanotos', 'Limnodromus semipalmatus', 'Gallinago stenura', 'Gallinago megala', 'Gallinago gallinago', 'Xenus cinereus', 'Phalaropus lobatus', 'Actitis hypoleucos', 'Tringa ochropus', 'Tringa brevipes', 'Tringa totanus', 'Tringa stagnatilis', 'Tringa glareola', 'Tringa erythropus', 'Tringa nebularia', 'Tringa guttifer', 'Glareola maldivarum', 'Glareola lactea', 'Chroicocephalus brunnicephalus', 'Chroicocephalus ridibundus', 'Gelochelidon nilotica', 'Hydroprogne caspia', 'Thalasseus bergii', 'Thalasseus bengalensis', 'Sternula albifrons', 'Onychoprion aleuticus', 'Onychoprion anaethetus', 'Sterna sumatrana', 'Sterna hirundo', 'Chlidonias hybrida', 'Chlidonias leucopterus', 'Stercorarius parasiticus', 'Stercorarius longicaudus', 'Oceanodroma monorhis', 'Ardenna tenuirostris', 'Anastomus oscitans', 'Leptoptilos javanicus', 'Fregata ariel', 'Sula sula', 'Sula leucogaster', 'Anhinga melanogaster', 'Plegadis falcinellus', 'Ixobrychus sinensis', 'Ixobrychus eurhythmus', 'Ixobrychus cinnamomeus', 'Ixobrychus flavicollis', 'Gorsachius melanolophus', 'Nycticorax nycticorax', 'Butorides striata', 'Ardeola grayii', 'Ardeola bacchus', 'Ardeola speciosa', 'Bubulcus coromandus', 'Ardea cinerea', 'Ardea sumatrana', 'Ardea purpurea', 'Ardea alba', 'Ardea intermedia', 'Egretta garzetta', 'Egretta sacra', 'Egretta eulophotes', 'Pandion haliaetus', 'Elanus caeruleus', 'Pernis ptilorhynchus', 'Aviceda jerdoni', 'Aviceda leuphotes', 'Gyps himalayensis', 'Spilornis cheela', 'Circaetus gallicus', 'Macheiramphus alcinus', 'Nisaetus cirrhatus', 'Lophotriorchis kienerii', 'Clanga clanga', 'Hieraaetus pennatus', 'Aquila nipalensis', 'Aquila heliaca', 'Accipiter trivirgatus', 'Accipiter badius', 'Accipiter soloensis', 'Accipiter gularis', 'Accipiter virgatus', 'Accipiter nisus', 'Circus spilonotus', 'Circus melanoleucos', 'Milvus migrans', 'Haliastur indus', 'Haliaeetus leucogaster', 'Haliaeetus ichthyaetus', 'Butastur indicus', 'Buteo buteo', 'Tyto javanica', 'Otus lempiji', 'Otus sunia', 'Bubo sumatranus', 'Ketupa ketupu', 'Strix seloputo', 'Strix leptogrammica', 'Ninox scutulata', 'Ninox japonica', 'Asio flammeus', 'Anthracoceros albirostris', 'Anthracoceros malayanus', 'Eurystomus orientalis', 'Pelargopsis capensis', 'Halcyon coromanda', 'Halcyon smyrnensis', 'Halcyon pileata', 'Alcedo meninting', 'Alcedo atthis', 'Ceyx erithaca', 'Ceryle rudis', 'Merops philippinus', 'Merops viridis', 'Psilopogon lineatus', 'Psilopogon rafflesii', 'Psilopogon haemacephalus', 'Yungipicus moluccensis', 'Dryocopus javensis', 'Chrysophlegma miniaceum', 'Picus puniceus', 'Picus vittatus', 'Dinopium javanense', 'Micropternus brachyurus', 'Meiglyptes tristis', 'Mulleripicus pulverulentus', 'Falco naumanni', 'Falco tinnunculus', 'Falco amurensis', 'Falco subbuteo', 'Falco peregrinus', 'Cacatua goffiniana', 'Cacatua sulphurea', 'Psittinus cyanurus', 'Psittacula alexandri', 'Psittacula longicauda', 'Psittacula krameri', 'Trichoglossus haematodus', 'Loriculus galgulus', 'Cymbirhynchus macrorhynchos', 'Calyptomena viridis', 'Pitta sordida', 'Pitta nympha', 'Pitta moluccensis', 'Pitta megarhyncha', 'Gerygone sulphurea', 'Hemipus hirundinaceus', 'Tephrodornis virgatus', 'Aegithina tiphia', 'Pericrocotus speciosus', 'Pericrocotus divaricatus', 'Lalage nigra', 'Lalage fimbriata', 'Pachycephala cinerea', 'Lanius tigrinus', 'Lanius cristatus', 'Lanius schach', 'Erpornis zantholeuca', 'Dicrurus macrocercus', 'Dicrurus leucophaeus', 'Dicrurus annectens', 'Dicrurus hottentottus', 'Dicrurus paradiseus', 'Rhipidura javanica', 'Hypothymis azurea', 'Terpsiphone paradisi', 'Terpsiphone affinis', 'Terpsiphone incei', 'Terpsiphone atrocaudata', 'Corvus splendens', 'Corvus macrorhynchos', 'Parus minor', 'Alauda arvensis', 'Pycnonotus zeylanicus', 'Microtarsus melanoleucos', 'Brachypodius melanocephalos', 'Rubigula flaviventris', 'Pycnonotus jocosus', 'Pycnonotus aurigaster', 'Pycnonotus plumosus', 'Pycnonotus simplex', 'Pycnonotus brunneus', 'Iole crypta', 'Ixos malaccensis', 'Hemixos cinereus', 'Riparia riparia', 'Hirundo tahitica', 'Delichon dasypus', 'Cecropis daurica', 'Phylloscopus inornatus', 'Phylloscopus fuscatus', 'Phylloscopus coronatus', 'Phylloscopus borealoides', 'Phylloscopus borealis', 'Acrocephalus orientalis', 'Acrocephalus bistrigiceps', 'Iduna caligata', 'Helopsaltes certhiola', 'Locustella lanceolata', 'Cisticola juncidis', 'Prinia flaviventris', 'Orthotomus sutorius', 'Orthotomus atrogularis', 'Orthotomus sericeus', 'Orthotomus ruficeps', 'Cyanoderma erythropterum', 'Mixornis gularis', 'Malacocincla abbotti', 'Malacopteron magnirostre', 'Pellorneum malaccense', 'Pellorneum rostratum', 'Garrulax leucolophus', 'Garrulax canorus', 'Zosterops simplex', 'Irena puella', 'Sitta frontalis', 'Gracula religiosa', 'Acridotheres cristatellus', 'Acridotheres tristis', 'Acridotheres melanopterus', 'Spodiopsar sericeus', 'Spodiopsar cineraceus', 'Agropsar sturninus', 'Agropsar philippensis', 'Sturnia sinensis', 'Sturnia pagodarum', 'Pastor roseus', 'Geokichla citrina', 'Geokichla sibirica', 'Turdus mandarinus', 'Turdus obscurus', 'Copsychus saularis', 'Copsychus malabaricus', 'Muscicapa griseisticta', 'Muscicapa sibirica', 'Muscicapa dauurica', 'Muscicapa williamsoni', 'Muscicapa ferruginea', 'Cyornis glaucicomans', 'Cyornis rufigastra', 'Cyornis brunneatus', 'Cyanoptila cyanomelana', 'Cyanoptila cumatilis', 'Eumyias thalassinus', 'Larvivora cyane', 'Ficedula zanthopygia', 'Ficedula narcissina', 'Ficedula elisae', 'Ficedula mugimaki', 'Ficedula albicilla', 'Phoenicurus auroreus', 'Monticola solitarius', 'Monticola gularis', 'Saxicola stejnegeri', 'Chloropsis sonnerati', 'Chloropsis cyanopogon', 'Chloropsis cochinchinensis', 'Prionochilus thoracicus', 'Dicaeum agile', 'Dicaeum chrysorrheum', 'Dicaeum trigonostigma', 'Dicaeum cruentatum', 'Chalcoparia singalensis', 'Anthreptes malacensis', 'Leptocoma brasiliana', 'Leptocoma calcostetha', 'Cinnyris jugularis', 'Aethopyga siparaja', 'Arachnothera longirostra', 'Arachnothera crassirostris', 'Arachnothera chrysogenys', 'Passer domesticus', 'Passer montanus', 'Ploceus manyar', 'Ploceus philippinus', 'Amandava amandava', 'Lonchura striata', 'Lonchura leucogastroides', 'Lonchura punctulata', 'Lonchura atricapilla', 'Lonchura maja', 'Dendronanthus indicus', 'Motacilla tschutschensis', 'Motacilla citreola', 'Motacilla cinerea', 'Motacilla alba', 'Anthus rufulus', 'Anthus hodgsoni', 'Anthus cervinus']

filter = datetime(2021,10,1)

with open('eBirdClean.csv', encoding="ISO-8859-1") as csv_file:
    csv_reader = csv.reader(csv_file, delimiter=',')

    with open('eBirdClean_OCT21.csv', mode='w', encoding="utf-8", newline = '') as testfile:
        writer = csv.writer(testfile, delimiter=',', quotechar='"', quoting=csv.QUOTE_MINIMAL)

        for row in csv_reader:
            time = row[8]
            rowTime = parser.parse(time)

            if (rowTime >= filter):
                writer.writerow(row)
